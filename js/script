// Funcionalidad para la m√∫sica
document.addEventListener('DOMContentLoaded', () => {
    const musicaFondo = document.getElementById('musicaFondo');
    musicaFondo.src = "musica/fondo.mp3";
    musicaFondo.volume = 0.5;

    // Reproducir audio solo si hay interacci√≥n del usuario
    document.getElementById('btnEntrar').addEventListener('click', () => {
        musicaFondo.play().catch(e => console.error("Error de reproducci√≥n de audio:", e));
    });
});

// Funcionalidad de las secciones
function mostrarSeccion(id) {
    const secciones = document.querySelectorAll('.pantalla');
    secciones.forEach(sec => sec.classList.add('hidden'));
    document.getElementById(id).classList.remove('hidden');
}

// Control del bot√≥n de entrada
document.getElementById('btnEntrar').addEventListener('click', () => {
    mostrarSeccion('menu');
});

// Peluches
const frasesTich = [
    "¬°Hola mi amor! Tich te da un saludito con mucho cari√±o.",
    "Estoy aqu√≠ para recordarte lo mucho que te amo."
];
const frasesCamila = [
    "Hola mi coraz√≥n. Camila te manda muchos abrazos y besos.",
    "Eres mi persona favorita en el mundo."
];

function hablar(peluche) {
    let frase;
    let fraseElement;
    if (peluche === 'tich') {
        frase = frasesTich[Math.floor(Math.random() * frasesTich.length)];
        fraseElement = document.getElementById('frase-tich');
    } else if (peluche === 'camila') {
        frase = frasesCamila[Math.floor(Math.random() * frasesCamila.length)];
        fraseElement = document.getElementById('frase-camila');
    }
    
    fraseElement.textContent = frase;
    fraseElement.classList.remove('hidden');

    setTimeout(() => {
        fraseElement.classList.add('hidden');
    }, 4000); // 4 segundos
}

// Modal peluches
function mostrarPeluche(peluche) {
    const modal = document.getElementById('modal-peluche');
    const titulo = document.getElementById('titulo-peluche');
    const texto = document.getElementById('texto-peluche');
    if (peluche === 'tich') {
        titulo.textContent = 'üß∏ Tich';
        texto.textContent = 'Mi amor, Tich es el perrito de mi hermana. Lo quiero mucho porque es la mascota de la familia. Me hace pensar en lo valioso que es el hogar y lo especial que es compartir la vida con los que amamos. Cuando lo abrazo, siento que estamos juntos, y por eso quise que fuera uno de mis peluches, para que sepas que siempre pienso en ti y en los tuyos. Lo compr√© pensando en lo mucho que me gustar√≠a abrazarte a ti. ‚ù§Ô∏è';
    } else if (peluche === 'camila') {
        titulo.textContent = 'üêª Camila';
        texto.textContent = 'Camila es mi osita, ella es el primer peluche que me regalaste. Cuando la abrazo me hace pensar en ti. La cuido con mucho cari√±o, porque ella representa lo mucho que te amo. Eres mi osito de miel favorito. La compr√© pensando en tu cumplea√±os y espero te guste, mi amor. üíñ';
    }
    modal.classList.remove('hidden');
}

function cerrarModalPeluche() {
    const modal = document.getElementById('modal-peluche');
    modal.classList.add('hidden');
}

// Modal para cartas
function abrirCarta(url, titulo) {
    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modal-titulo');
    const modalBody = document.getElementById('modal-body');
    modalTitle.textContent = titulo;
    modalBody.innerHTML = `<iframe src="${url}"></iframe>`;
    modal.classList.remove('hidden');
}

document.getElementById('modalClose').addEventListener('click', () => {
    document.getElementById('modal').classList.add('hidden');
    document.getElementById('modal-body').innerHTML = ''; // Limpiar el iframe
});

// Modal para las fotos
function abrirModalImagen(src) {
    const modal = document.getElementById('modal-imagen');
    const imagenAmpliada = document.getElementById('imagen-ampliada');
    imagenAmpliada.src = src;
    modal.classList.remove('hidden');
}
function cerrarModalImagen() {
    document.getElementById('modal-imagen').classList.add('hidden');
    document.getElementById('imagen-ampliada').src = "";
}

// Funcionalidad para la secci√≥n de "Ver Pel√≠cula"
document.getElementById('copiarLink').addEventListener('click', function() {
    const linkInput = document.getElementById('linkPelicula');
    
    // Selecciona el texto dentro del input
    linkInput.select();
    linkInput.setSelectionRange(0, 99999); // Para dispositivos m√≥viles
    
    // Copia el texto al portapapeles
    navigator.clipboard.writeText(linkInput.value).then(function() {
        alert('¬°Link de la pel√≠cula copiado!');
    }, function(err) {
        alert('Error al copiar el link: ' + err);
    });
});

// Funcionalidad para la secci√≥n "Te extra√±o"
document.getElementById('btnExtra√±o').addEventListener('click', function() {
  if (window.OneSignal) {
    // T√≠tulo y mensaje de la notificaci√≥n
    const titulo = "¬°Te extra√±o mucho!";
    const mensaje = "Tu amor me est√° pidiendo un abrazo virtual. ‚ù§Ô∏è";

    // Env√≠a la notificaci√≥n directamente al dispositivo suscrito
    OneSignal.sendSelfNotification(titulo, mensaje);

    alert("¬°Mensaje enviado! Tu amor ya sabe que la extra√±as.");
  } else {
    alert("¬°Ocurri√≥ un error! La conexi√≥n con el servicio no est√° lista.");
  }
});
